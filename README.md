# Skybolt Go

High-performance asset caching for multi-page applications.

## Installation

```bash
go get github.com/JensRoland/skybolt-go
```

## Usage

```go
package main

import (
    "net/http"

    skybolt "github.com/JensRoland/skybolt-go"
)

func handler(w http.ResponseWriter, r *http.Request) {
    // Get cookies from request
    cookies := make(map[string]string)
    for _, c := range r.Cookies() {
        cookies[c.Name] = c.Value
    }

    // Initialize Skybolt
    sb, err := skybolt.New("static/.skybolt/render-map.json", cookies, "")
    if err != nil {
        http.Error(w, err.Error(), http.StatusInternalServerError)
        return
    }

    // Use in your template
    fmt.Fprintf(w, `<!DOCTYPE html>
<html>
<head>
    %s
    %s
    %s
</head>
<body>
    <!-- content -->
    %s
</body>
</html>`,
        sb.CSS("src/css/critical.css"),
        sb.LaunchScript(),
        sb.CSS("src/css/app.css"),
        sb.Script("src/js/app.js", true),
    )
}
```

## Gin Integration

```go
package main

import (
    "github.com/gin-gonic/gin"
    skybolt "github.com/JensRoland/skybolt-go"
)

func main() {
    r := gin.Default()
    r.LoadHTMLGlob("templates/*")

    r.GET("/", func(c *gin.Context) {
        cookies := make(map[string]string)
        for _, cookie := range c.Request.Cookies() {
            cookies[cookie.Name] = cookie.Value
        }

        sb, _ := skybolt.New("static/.skybolt/render-map.json", cookies, "")

        c.HTML(200, "index.html", gin.H{
            "sb": sb,
        })
    })

    r.Run(":8080")
}
```

## API Reference

### `New(renderMapPath string, cookies map[string]string, cdnURL string) (*Skybolt, error)`

Create a new Skybolt instance.

- `renderMapPath`: Path to render-map.json generated by Vite plugin
- `cookies`: Cookie map (can be nil)
- `cdnURL`: Optional CDN URL prefix (can be empty)

### `CSS(entry string) string`

Render CSS asset. Returns HTML string.

### `Script(entry string, module bool) string`

Render JavaScript asset. Returns HTML string.

### `LaunchScript() string`

Render the Skybolt client launcher script. Call once in `<head>`.

### `Preload(entry, asType, mimeType, crossorigin, fetchpriority string) string`

Render preload link for critical resources.

### `GetAssetURL(entry string) string`

Get URL for an asset (for manual use cases).

### `GetAssetHash(entry string) string`

Get hash for an asset (for manual use cases).

## License

MIT
